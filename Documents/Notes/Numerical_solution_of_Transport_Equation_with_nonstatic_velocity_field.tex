\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{comment}
\usepackage[russian]{babel}
\usepackage[OT1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\author{GSench}
\title{Численное решение Уравнения Переноса в одномерном случае при переменном поле скоростей}
\begin{document}
\section{Уравнение Переноса}
Уравнение переноса в общем случае имеет следующий вид:
\begin{equation}
\frac{\partial f}{\partial t}+\nabla\cdot(f\overrightarrow{u})=0
\end{equation}
Где u – векторное поле скоростей, f - переносимая скалярная величина, $ \nabla $ – оператор дивергенции. Определим f как функцию Хевисайда, принимающую значения 0 и 1:
\begin{equation}
f(x,t)=\begin{cases}1 & {\bf x}\in liquid \\0 & {\bf x}\not\in liquid\end{cases}
\end{equation}
В одномерном случае уравнение сводится к виду:
\begin{equation}
\label{eqn:TE1D}
\frac{\text{d}f_{x}}{\text{d}t} + \frac{\text{d}(f_{x}u_{x})}{\text{d}x}=0
\end{equation}
В дальнейшем будем обозначать $f_x$ $u_x$ просто как $f$ и $u$, подразумевая значения, взятые вдоль направлений соответствующих осей.

\section{Численное решение}
\subsection{Численное решение в общем случае}
Для численного решения проводится дискретизация:

Отрезок $[0;X]$, на котором рассматривается данное уравнение, разбивается на $cellCount$ последовательных подотрезков, длиной $\Delta x_i$ каждый – ячейки сетки. i=1..cellCount. Положения $x_{i-\frac{1}{2}}$, $x_{i+\frac{1}{2}}$ являются узлами данной сетки (ребрами ячеек). $\Delta x_i=x_{i+\frac{1}{2}}-x_{i-\frac{1}{2}}$. Для реализации программы была выбрана равномерная сетка с ячейками равной длины $\Delta x$. Зададим длину временного шага $\Delta t$ и построим схему для вычисления средних значений функции $f(x,t)$ в каждой ячейке.
\begin{equation}
\overline{f}_i^n=\frac{1}{\Delta x_i}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}f(x,t_n)dx 
\end{equation}
- среднее по ячейке значение функции $f(x,t)$ на i-ом отрезке $\Delta x_i$ на n-ом временном шаге. В дальнейшем будем обозначать его как просто $f_i^n$.

Проинтегрируем уравнение переноса в одномерном случае (\ref{eqn:TE1D}) по времени на шаге $[t_n; t_{n+1}]$:
\[
(f^{n+1}-f^n)+\int_{t_n}^{t_{n+1}}\frac{\text{d}(f u)}{\text{d}x}d\tau=0
\]
Для численного дифференцирования используем явную разностную схему 2 порядка:
\[
\frac{\text{d}(f u)}{\text{d}x}=\frac{f_{i+\frac{1}{2}}u_{i+\frac{1}{2}}-f_{i-\frac{1}{2}}u_{i-\frac{1}{2}}}{\Delta x_i}
\]
В результате уравнение переноса преобразуется к виду:
\begin{equation}
\label{eqn:TE1DdiffScheme}
(f_i^{n+1}-f_i^n)
+
\frac{1}{\Delta x_i}
\int_{t_n}^{t_{n+1}}
f_{i+\frac{1}{2}}u_{i+\frac{1}{2}}d\tau
-
\frac{1}{\Delta x_i}
\int_{t_n}^{t_{n+1}}
f_{i-\frac{1}{2}}u_{i-\frac{1}{2}} d\tau
=0
\end{equation}

\subsection{Поле скоростей твердого тела}
Поле скоростей твердого тела связано по формуле Эйлера:
\[
\overrightarrow{u}(\overrightarrow{r},t)=\overrightarrow{v_c}(t)+[\overrightarrow{\omega}(t)\times \overrightarrow{r}(t)]
\]
Рассмотрим составляющие поля скоростей вдоль направлений X,Y,Z:
\[ \overrightarrow{u}(\overrightarrow{r},t)=(u_x, u_y, u_z)(\overrightarrow{r},t) \]
\[ \overrightarrow{r}(t)=(x-x_c(t), y-y_c(t), z-z_c(t)) \]
Векторы $\overrightarrow{v_c}(t)$ и $\overrightarrow{\omega}(t)$ считаются заданными.
\[ \overrightarrow{v_c}(t)=(v_{cx}(t), v_{cy}(t), v_{cz}(t)) \]
\[ \overrightarrow{\omega}(t)=(\omega_x(t), \omega_y(t), \omega_z(t)) \]

\[ u_x(t)=v_{cx}(t)+\omega_y(t)z-\omega_y(t)z_c(t)-\omega_z(t)y+\omega_z(t)y_c(t) \]
\[ u_y(t)=v_{cy}(t)-\omega_x(t)z+\omega_x(t)z_c(t)+\omega_z(t)x-\omega_z(t)x_c(t) \]
\[ u_z(t)=v_{cz}(t)+\omega_x(t)y-\omega_x(t)y_c(t)-\omega_y(t)x+\omega_y(t)x_c(t) \]
Таким образом, можно видеть, что скорости твердого тела вдоль каждого из направлений не зависят от координаты рассматриваемой точки на этом направлении. То есть, например, скорости $u_x$ твердого тела вдоль направления $OX$ не зависят от координаты $x$, а лишь от положения $y$ и $z$ и от времени $t$.

В таком случае, при решении уравнения переноса мы можем рассматривать скорость постоянной вдоль каждого из направлений, но зависящей от времени. Поэтому вместо $u_{i-\frac{1}{2}}$, $u_{i+\frac{1}{2}}$ будем рассматривать $u$, зависящую от времени.

\subsection{Численное решение для нестационарного поля скоростей твердого тела}
Перепишем уравнение (\ref{eqn:TE1DdiffScheme}), полученное для произвольного поля скоростей, для поля скоростей твердого тела:
\[
(f_i^{n+1}-f_i^n)
+
\frac{1}{\Delta x_i}
\int_{t_n}^{t_{n+1}}
{u}f_{i+\frac{1}{2}}d\tau
-
\frac{1}{\Delta x_i}
\int_{t_n}^{t_{n+1}}
{u}f_{i-\frac{1}{2}}d\tau
=0
\]
Для вычисления интегралов используем квадратурную формулу трапеции:
\[
\int_{t_n}^{t_{n+1}}{u}f_{i+\frac{1}{2}}d\tau =
\Delta t \frac{
u^{t_{n+1}}f_{i+\frac{1}{2}}^{t_{n+1}} +
u^{t_{n}}f_{i+\frac{1}{2}}^{t_{n}}
}{2}
\]
\[
\int_{t_n}^{t_{n+1}}{u}f_{i-\frac{1}{2}}d\tau =
\Delta t \frac{
u^{t_{n+1}}f_{i-\frac{1}{2}}^{t_{n+1}} +
u^{t_{n}}f_{i-\frac{1}{2}}^{t_{n}}
}{2}
\]
Используем данные квадратурные формулы для приближенного вычисления интегралов, подставим их в уравнение:
\begin{equation}
\label{eqn:TERB1D}
(f_i^{n+1}-f_i^n)
+
\frac{\Delta t}{2\Delta x_i} (
u^{t_{n+1}}f_{i+\frac{1}{2}}^{t_{n+1}}
+ u^{t_{n}}f_{i+\frac{1}{2}}^{t_{n}}
- u^{t_{n+1}}f_{i-\frac{1}{2}}^{t_{n+1}}
- u^{t_{n}}f_{i-\frac{1}{2}}^{t_{n}}
)=0
\end{equation}
Значения $u^{t^*}f_{x^*}^{t^*}=\Phi_{x^*}^{t^*}$ представляют собой потоки через грани ячеек. Значения $f_{x^*}^{t^*}$ могут быть вычислены с использованием интерполяционной функции соответствующей методу решения. То есть будут вычислены, как
\begin{equation}
\label{eqn:PsyIntrpolationFunc}
f_{x^*}^{t^*} = \begin{cases}
\Psi_{L}(x(x^*,\tau^*))
& \int_{t_n}^{t_{n+1}} u^{\tau}d\tau\geq0
\\
\Psi_{R}(x(x^*,\tau^*))
& \int_{t_n}^{t_{n+1}} u^{\tau}d\tau < 0
\end{cases}
\end{equation}
Таким образом, реализуется метод \textit{upwind}: расчета потоков через грани по направлению переноса.
То есть, при вычислении потока $\Phi_{x^*}^{t^*}$ для положительной скорости $u$ переноса на грани ячейки $x^*$ в течение шага $[t_n; t_{n+1}]$, будет использована интерполяционная функция $\Psi_{j}^{t^*}(x(x^*,t^*))$, построенная на ячейке $j$ слева от данной грани $x^*$, а при вычислении потока для отрицательной скорости $u$ будет использована интерполяционная функция $\Psi_{j}^{t^*}(x(x^*,t^*))$, построенная на ячейке $j$ справа от данной грани $x^*$.
\\В соответствии с использованными разностными схемами и квадратурными формулами выбранного метода решения необходимо рассчитать следующие потоки:
\begin{equation}
\label{eqn:FlowLCurr}
\Phi_{i-\frac{1}{2}}^n=\begin{cases}
u^{t_n} \Psi_{i-1}(x(x_{i-\frac{1}{2}}, 0))
& u^{t_n}+u^{t_{n+1}}\geq0
\\
u^{t_n} \Psi_{i}(x(x_{i-\frac{1}{2}}, 0))
& u^{t_n}+u^{t_{n+1}}<0
\end{cases}
\end{equation}
\begin{equation}
\label{eqn:FlowRCurr}
\Phi_{i+\frac{1}{2}}^n=\begin{cases}
u^{t_n} \Psi_{i}(x(x_{i+\frac{1}{2}}, 0))
& u^{t_n}+u^{t_{n+1}}\geq0
\\
u^{t_n} \Psi_{i+1}(x(x_{i+\frac{1}{2}}, 0))
& u^{t_n}+u^{t_{n+1}}<0
\end{cases}
\end{equation}
\begin{equation}
\label{eqn:FlowLNext}
\Phi_{i-\frac{1}{2}}^{n+1}=\begin{cases}
u^{t_{n+1}} \Psi_{i-1}(x(x_{i-\frac{1}{2}}, \Delta t))
& u^{t_n}+u^{t_{n+1}}\geq0
\\
u^{t_{n+1}} \Psi_{i}(x(x_{i-\frac{1}{2}}, \Delta t))
& u^{t_n}+u^{t_{n+1}}<0
\end{cases}
\end{equation}
\begin{equation}
\label{eqn:FlowRNext}
\Phi_{i+\frac{1}{2}}^{n+1}=\begin{cases}
u^{t_{n+1}} \Psi_{i}(x(x_{i+\frac{1}{2}}, \Delta t))
& u^{t_n}+u^{t_{n+1}}\geq0
\\
u^{t_{n+1}} \Psi_{i+1}(x(x_{i+\frac{1}{2}}, \Delta t))
& u^{t_n}+u^{t_{n+1}}<0
\end{cases}
\end{equation}
Подставляя значения потоков (\ref{eqn:FlowLCurr}-\ref{eqn:FlowRNext}) в уравнение переноса для твердого тела в одномерном случае в виде разностной схемы (\ref{eqn:TERB1D}), получим выражение для расчета объемной доли переносимой скалярной величины в ячейке $\Delta x_i$ на следующем временном шаге $t_{n+1}$:
\begin{equation}
\label{eqn:fNext}
f_i^{n+1}=f_i^n +
\frac{\Delta t}{2\Delta x_i} (
\Phi_{i+\frac{1}{2}}^{n+1}
+ \Phi_{i+\frac{1}{2}}^n
- \Phi_{i-\frac{1}{2}}^{n+1}
- \Phi_{i-\frac{1}{2}}^n
)=0
\end{equation}
\\В дальнейшем для выбора интерполяционной функции $\Psi_{j}$ в исследовании будут рассмотрены такие методы, как метод Годунова (интерполяция константой), метод MUSCL (линейная интерполяция), метод THINC (интерполяция гиперболическим тангенсом) и метод Jump Reconstruction (интерполяция скачком).

\section{Метод характеристик}
\begin{comment}
https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D1%85%D0%B0%D1%80%D0%B0%D0%BA%D1%82%D0%B5%D1%80%D0%B8%D1%81%D1%82%D0%B8%D0%BA
\end{comment}
Рассмотрим решение уравнения переноса с помощью метода характеристик.
\begin{equation}
\frac{\text{d}f}{\text{d}t} + \frac{\text{d}(f u)}{\text{d}x}=0
\end{equation}
Нам бы хотелось свести это дифференциальное уравнение в частных производных первого порядка к обыкновенному дифференциальному уравнению вдоль соответствующей кривой, то есть получить уравнение вида:
\[
\frac{\text{d}}{\text{d}s}f(x(s),t(s))=F(f,x(s),t(s))
\]
где кривая $(x(s),t(s))$ — характеристика.\\
Установим, что
\begin{equation}
\label{eqn:CharacteristicsMethodEq}
\frac{\text{d}}{\text{d}s}f(x(s),t(s))=\frac{\partial f}{\partial x}\frac{\text{d}x}{\text{d}s}+\frac{\partial f}{\partial t}\frac{\text{d}t}{\text{d}s}
\end{equation}
Положим, что
\[
\frac{\text{d}t}{\text{d}s}=1
\]
Следовательно, при $t(0)=0$, $s=t$. И теперь будем составлять ОДУ, используя метод характеристик в виде:
\[
\frac{\text{d}}{\text{d}t}f(x(t),t)=F(f,x(t),t)
\]
Будем искать решение вдоль характеристик, уравнение которых имеет вид:
\[
\frac{\text{d}x}{\text{d}t}=u(t)
\]
В таком случае уравнение (\ref{eqn:CharacteristicsMethodEq}) можно переписать в виде:
\[
\frac{\text{d}}{\text{d}t}f(x(t),t)=u(t)\frac{\partial f}{\partial x}+\frac{\partial f}{\partial t}
\]
таким образом, вдоль характеристики $(x(t),t)$ исходное уравнение в частных производных превращается в ОДУ:
\[
f'_t=F(f,x(t),t)=0
\]
Данное уравнение говорит о том, что вдоль характеристик решение постоянное. Таким образом, $f(x,t)=f(x_0,0)$, где точки $(x,t)$ и $(x_0,0)$ лежат на одной характеристике. Видно, что для нахождения общего решения достаточно найти характеристики уравнения в виде:
\begin{equation}
\label{eqn:CharacteristicsEq}
\frac{\text{d}x}{\text{d}t}=u(t)
\end{equation}
Будем искать решение на временном слое $t_n$.
\\$\tau$ - время на слое $[t_n; t_{n+1}]$. То есть $\tau=0 \Leftrightarrow t=t_n$, $\tau=\Delta t \Leftrightarrow t=t_{n+1}$.
\\Проинтегрируем уравнение (\ref{eqn:CharacteristicsEq}) по $t$ от $t_n$ до $t_n+\tau$:
\begin{equation}
\label{eqn:CommonCharacteristics}
x(t_n+\tau)-x(t_n)=\int_{t_n}^{t_n+\tau}u(t)dt + C
\end{equation}
Что является общим видом характеристической функции для данного уравнения в частных производных.
\\Найдем такую характеристику, которая в момент времени $\tau^*$ проходила через точку $x^*$. Подставим в характеристическую функцию (\ref{eqn:CommonCharacteristics}) данные начальные условия:
\[
x(t_n+\tau^*)-x(t_n)=\int_{t_n}^{t_n+\tau^*}u(t)dt + C^*
\]
Тогда
\[
C^* = x^*-x(t_n)-\int_{t_n}^{t_n+\tau^*}u(t)dt
\]
Подставим $C^*$ обратно в общий вид уравнения характеристической функции (\ref{eqn:CommonCharacteristics}), чтобы получить характеристику:
\[
x(t_n+\tau)-x(t_n)=\int_{t_n}^{t_n+\tau}u(t)dt + x^*-x(t_n)-\int_{t_n}^{t_n+\tau^*}u(t)dt
\]
\begin{equation}
\label{eqn:Characteristic}
x(t_n+\tau)=\int_{t_n}^{t_n+\tau}u(t)dt + x^*-\int_{t_n}^{t_n+\tau^*}u(t)dt
\end{equation}
Узнаем координату, из которой выходила данная характеристика в момент времени $\tau=0$:
\[
x\mid_{\tau=0}=\int_{t_n}^{t_n}u(t)dt + x^*-\int_{t_n}^{t_n+\tau^*}u(t)dt
\]
\begin{equation}
\label{eqn:CharacteristicFromZero}
x\mid_{\tau=0}=x^*-\int_{t_n}^{t_n+\tau^*}u(t)dt
\end{equation}


\end{document}